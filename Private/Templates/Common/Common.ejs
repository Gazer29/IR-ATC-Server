//
// Common.ejs
//
// Provides common functionality for other ESP scripts to include.

// Returns the number of contacts in the list.
function GetNumberOfContacts()
{
	// Important: All values retrieved from the form[] hash are strings,
	// but we want the 'length' as a number for use in a for() statement.  
	// Make Javascript turn it into a number by multiplying by 1.
	return form["length"] * 1;
}

// Returns the ID of the contact in the list at index.
function GetContactID(index)
{
	return form["id" + index];
}

// Outputs the HTML of a table header for each element in the contact data.
function WriteListHeader(pageURL)
{
	var sortMode = form["sortMode"] * 1; // Retrieve the sortMode as a number
	var ascending = form["ascending"];
	var sortArrow = new Array();
	var sortAscending = new Array();

	// Only set the values in the sortArrow and sortAscending arrays for the
	// element at index sortMode. All other values will remain empty.
	if (ascending == "1")
	{
		sortAscending[sortMode] = "&amp;ascending=0"; // Toggle off ascending.
		sortArrow[sortMode] = " &#9650;"; // Up arrow.
	}
	else
	{
		sortArrow[sortMode] = " &#9660;"; // Down arrow.
	}
	
	// In EJS, the write function provides the same functionality as text
	// outside of the <% %> tag in ESP.
	write('<th><a href="' + pageURL + 'sortMode=1' + sortAscending[1] + '">ID' + sortArrow[1] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=2' + sortAscending[2] + '">Name' + sortArrow[2] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=3' + sortAscending[3] + '">UUID' + sortArrow[3] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=4' + sortAscending[4] + '">Destination' + sortArrow[4] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=5' + sortAscending[5] + '">Distance' + sortArrow[5] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=6' + sortAscending[6] + '">Next Destination' + sortArrow[6] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=7' + sortAscending[7] + '">Position XYZ' + sortArrow[7] + '</a></th>\n');
	write('<th><a href="' + pageURL + 'sortMode=8' + sortAscending[8] + '">1' + sortArrow[8] + '</a></th>\n');
}

// Outpus the HTML of table row for each element in the contact data.
function WriteContactData(index)
{
	write('<td>' + form["id" + index] + '</td>\n');
	write('<td>' + form["name" + index] + '</td>\n');
	write('<td>' + form["uuid" + index] + '</td>\n');
	write('<td>' + form["dest1" + index] + '</td>\n');
	write('<td>' + form["dis" + index] + '</td>\n');
	write('<td>' + form["dest2" + index] + '</td>\n');
	write('<td>' + form["pos" + index] + '</td>\n');
	write('<td>' + form["1" + index] + '</td>\n');
}
